import fetch from 'node-fetch';

const token = 'EAAUpPO0SIEABOz5LAiKQHLRK6ZCRxh5vrdzZAjWCnAD3uMZCg9nWOio7UaPSxbU2Or9Ae3fEL9wa1VIbQG5D99uTQRMcqQLVQu8CqJ0B68wwcQECIAFaNSP4L4Pa29wcYW0GAOM4aB7MUe6vViCc55KLaqlYg5QpBq9xwxZB8OSeWIXJfx1PV0MN8SXC9Bob3oZCtZAQShm6YN8Lo5US8Nuw0LswZDZD';

async function testToken() {
  try {
    console.log('ğŸ” Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù€ Token...');
    
    // Ø§Ø®ØªØ¨Ø§Ø± Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØµÙØ­Ø©
    const pageResponse = await fetch(`https://graph.facebook.com/v18.0/me?access_token=${token}`);
    const pageData = await pageResponse.json();
    
    if (pageData.error) {
      console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù€ Token:', pageData.error);
      return;
    }
    
    console.log('âœ… Ø§Ù„Ù€ Token ØµØ­ÙŠØ­');
    console.log('ğŸ“„ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØµÙØ­Ø©:', {
      name: pageData.name,
      id: pageData.id,
      category: pageData.category
    });
    
    // Ø§Ø®ØªØ¨Ø§Ø± Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø©
    console.log('\nğŸ§ª Ø§Ø®ØªØ¨Ø§Ø± Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© ØªØ¬Ø±ÙŠØ¨ÙŠØ©...');
    const testMessage = {
      recipient: { id: '30517453841172195' }, // Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ù† Ø§Ù„Ù€ logs
      message: { text: 'Ø±Ø³Ø§Ù„Ø© Ø§Ø®ØªØ¨Ø§Ø± Ù…Ù† Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯! ğŸ‰\n\nØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù€ Token Ø¨Ù†Ø¬Ø§Ø­ ÙˆØ§Ù„Ù†Ø¸Ø§Ù… ÙŠØ¹Ù…Ù„ Ø§Ù„Ø¢Ù†!' }
    };
    
    const sendResponse = await fetch(`https://graph.facebook.com/v18.0/me/messages?access_token=${token}`, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify(testMessage)
    });
    
    const sendData = await sendResponse.json();
    
    if (sendData.error) {
      console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø©:', sendData.error);
      
      // ØªÙØ§ØµÙŠÙ„ Ø¥Ø¶Ø§ÙÙŠØ© Ø¹Ù† Ø§Ù„Ø®Ø·Ø£
      if (sendData.error.code === 10) {
        console.log('ğŸ’¡ Ø§Ù„Ø­Ù„: ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ø±Ø³Ù„ Ø±Ø³Ø§Ù„Ø© Ù„Ù„ØµÙØ­Ø© Ø£ÙˆÙ„Ø§Ù‹');
      } else if (sendData.error.code === 200) {
        console.log('ğŸ’¡ Ø§Ù„Ø­Ù„: ØªØ£ÙƒØ¯ Ù…Ù† ØµÙ„Ø§Ø­ÙŠØ§Øª pages_messaging');
      }
    } else {
      console.log('âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­!');
      console.log('ğŸ“¨ Ù…Ø¹Ø±Ù Ø§Ù„Ø±Ø³Ø§Ù„Ø©:', sendData.message_id);
    }
    
    // Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©
    console.log('\nğŸ” Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØµÙØ­Ø©...');
    const fieldsResponse = await fetch(`https://graph.facebook.com/v18.0/me?fields=id,name,category,access_token&access_token=${token}`);
    const fieldsData = await fieldsResponse.json();
    
    if (fieldsData.error) {
      console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª:', fieldsData.error);
    } else {
      console.log('âœ… Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©:', fieldsData);
    }
    
  } catch (error) {
    console.error('âŒ Ø®Ø·Ø£:', error.message);
  }
}

testToken();
